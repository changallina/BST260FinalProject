---
title: "BST260FinalProject"
output: html_document
---


```{r}
library(tidyverse)
library(ggplot2)
library(rvest)
library(maps)
```

```{r}
# import datasets
install.packages("gsheet")
library(gsheet)
url20 <- "https://docs.google.com/spreadsheets/d/1vkHkvnZFhtekjkYbF-y7uVo4oE36ROaqJx4lxVIkdq4/edit?usp=sharing"
dat20 <- gsheet2tbl(url20, sheetid = NULL)

#shiny
dat2_1 <- "https://docs.google.com/spreadsheets/d/1bAzkkXU3W7LALAzP2cnaahbf-s52kr8GvjJ3pIaK9Cs/edit?usp=sharing"
whr2_1 <- gsheet2tbl(dat2_1, sheetid = NULL)
```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
world_map = map_data("world")

#dat20[is.na(match(dat20$`Country name`, world_map$region)), ]

dat20 <- dat20 %>%
  mutate(new_names = recode(`Country name`,
    "United Kingdom" = "UK",
    "United States" = "USA",
    "Taiwan Province of China" = "Taiwan",
    "Trinidad and Tobago" = "Trinidad",
    "North Cyprus" = "Cyprus",
    "Hong Kong S.A.R. of China" = "Hong Kong",
    "Palestinian Territories" = "Palestine",
    "Congo (Brazzaville)" = "Democratic Republic of the Congo"
  )
  )

world_map <- within(world_map, region[region == "China" & subregion == "Hong Kong"] <- "Hong Kong")

world_map <- world_map %>%
  rename("Country" = region)

dat20 <- dat20 %>%
  rename("Country" = new_names)

combined_countries <- full_join(dat20, world_map)

ggplot(combined_countries, 
       aes(x = long, y = lat, group = group, fill = combined_countries$`Ladder score`)) +
  geom_polygon() +
  scale_fill_viridis_c() +
  theme(panel.grid.major = element_blank(), 
        panel.background = element_blank(),
        axis.title = element_blank(), 
        axis.text = element_blank(),
        axis.ticks = element_blank())
```

## Including Plots

You can also embed plots, for example:

```{r}
whr2_1$year <- as.Date(whr2_1$year)
whr2_1 %>% filter (`Country name` == "Afghanistan") %>% 
  ggplot(aes(x = year, y = `Life Ladder`, color = `Country name`)) +
    geom_line() +
    scale_x_continuous(breaks = c(2007, 2020))
```


